<% t = Time.new %>

<div class="flex flex-row">
  <div class="basis-1/12 justify-items-center">


    <div class="content-center self-center justify-items-center my-16">
      <div class="flex flex-col self-center">
        <div class="bg-green-500 h-12 w-12 px-1 py-1 rounded-xl self-center">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="white" class="w-10 h-10 self-center">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
          </svg>
        </div>
        <div class="text-xs mt-2 m-auto self-center">
          Track time
        </div>
      </div>
    </div>


  </div>

  <div class="basis-10/12 flex flex-col h-100 ">
    <div class="grid grid-cols-12">
      <div class="col-span-1 flex  ">
        <div class="border rounded p-2 ">
          <%= link_to root_path(date: @chosen_date - 1.day) do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
            </svg>
          <% end %>
        </div>
        <div class="border rounded p-2">
          <%= link_to root_path(date: @chosen_date + 1.day) do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
          <% end %>
        </div>
      </div>
      <div class="col-span-8 flex text-3xl self-end">
        <% if @chosen_date == Date.today %>
          <p class="bold mr-2">
          Today: 
        <% end %>

        <p class="text-2xl  self-end">
        <%= @chosen_date.strftime("%A, %d %B") %>
        </p>
      </div>

      <div class="col-span-3 flex">
        <div>
          <%= form_tag(root_path, method: "get") do %>
            <%= date_field_tag :date, @chosen_date %>
            <%= submit_tag "Go to date", class: "bg-green-200 p-1 rounded" %>
          <% end %>
        </div>
      </div>
    </div>



    <div class="flex flex-row items-center content-center mt-6">
      <% Date::DAYNAMES.rotate.each_with_index do |day, i| %>
        <div class="grid grow <%= 'border-b-2 border-red-300' if @chosen_date.strftime("%A") == 'Monday' %>">

          <%= day %><br>
          <% day_minutes = @time_regs_week.select{ |tr| tr.date_worked.wday == (i+1) % 7 }.sum(&:minutes) %>
          <%= format_duration(day_minutes) %>
        </div>
      <% end %>

      <div class="grid grow">
        Week total
        <br />
        <%= format_duration(@total_minutes_week) %>
      </div>

    </div>



    <div class="border-y-2 divide-y-2">
      <table>
        <tbody>
          <% @time_regs.each do |time_reg| %>
            <tr>
              <div class="bg-yellow-100 p-2 divide-y-2">
                <div class="flex ">
                  <div class="grow">
                    <b class="mr-2"> Example Project</b>(Example client)
                    <br>
                    <%= time_reg.notes %>
                  </div>
                  <div class="flex items-center justify-between">
                    <span class="font-semibold"><%= convert_time(time_reg)%></span>
                    <%= link_to "Edit entry", edit_time_reg_path(time_reg), class: 'rounded bg-blue-200 p-2 m-2 hover:bg-blue-300 whitespace-nowrap' %>
                    <% if time_reg.active %>
                      <%= button_to "Stop", time_reg_toggle_active_path(time_reg_id: time_reg.id), method: :patch, class: "text-sm rounded bg-red-200 p-1 hover:bg-red-300" %>
                    <% else %>
                      <%= button_to "Start", time_reg_toggle_active_path(time_reg_id: time_reg.id), method: :patch, class: "text-sm rounded bg-green-200 p-1 hover:bg-green-300" %>
                    <% end %>
                  </div> 
                </div>
                <!-- Add more cells for other TimeEntry attributes -->
            </tr>
          <% end %>
        </tbody>
      </table>
              </div>
              <div class='text-end mt-6 mr-24'>
                Total: <%= format_duration(@total_minutes_day) %>
              </div>
    </div>
  </div>








  <%= link_to "clients", clients_path, class: "border-2" %>



